@using System.Net;
@using TalonAdmin.Extensions;
@{
    Layout = "ReportLayout.cshtml";
}
@foreach (var page in Model.Pages)
{
    <div class="page@(page.IsLastPage?" last-page":"")">
        <div class="row">
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-xs-12 text-center title">
                        <h1>Program Closure Report</h1>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-6">
                        <h5><strong>Country Office:&nbsp;</strong>@Model.Country.Name</h5>
                        <h5><strong>Program Name:&nbsp;</strong>@Model.Program.Name</h5>
                        <h5><strong>Fund Code:&nbsp;</strong>@Model.Program.FundCodes</h5>
                    </div>
                    <div class="col-xs-2">
                    </div>
                    <div class="col-xs-6">
                    </div>
                </div>
            </div>
            <div class="col-xs-2">
                <img src="@Model.Organization.LogoSVG" class="img-responsive pull-right" style="width: 2cm" />
            </div>
        </div>
        <div class="table">
            <table class="table table-striped table-bordered table-condensed">
                <thead>
                    <tr>
                        <th style="width: 5%" rowspan="2">#</th>
                        <th rowspan="2">Vendor Name</th>
                        <th style="width: 10%" rowspan="2">Id Number</th>
                        <th style="width: 10%" rowspan="2">Mobile Number</th>
                        <th style="width: 10%" rowspan="2">Location</th>
                        <th colspan="2" class="text-center" style="border-bottom: 0px">Redeemed Vouchers</th>
                    </tr>
                    <tr>
                        <th style="width: 13%">Total Number</th>
                        <th style="width: 13%">Total Value</th>
                    </tr>
                </thead>
                <tbody>
                    @for (var i = 0; i < page.Items.Length; i++)
                    {
                        var item = page.Items[i];
                        <tr>
                            <td>@(((page.Page - 1) * Model.PageSize) + i + 1)</td>
                            <td>@item.Vendor.Name</td>
                            <td>@(String.IsNullOrEmpty(item.Vendor.NationalId) ? "Not Recorded" : item.Vendor.NationalId)</td>
                            <td>@item.Vendor.MobileNumber</td>
                            <td>@(item.Vendor.Location != null ? item.Vendor.Location.Name : "")</td>
                            <td class="text-right">@item.NumberOfVouchers</td>
                            <td class="text-right">@Model.Country.CurrencyIsoCode @item.TotalValue</td>
                        </tr>
                    }
                </tbody>
                <tfoot>
                    @if (page.Items.Length > 1)
                    {
                        <tr>
                            <th colspan="6" class="text-right">Subtotal</th>
                            <th>@Model.Country.CurrencyIsoCode @page.SubTotal</th>
                        </tr>
                    }
                    @if (page.IsLastPage)
                    {

                        <tr>
                            <th colspan="6" class="text-right">Total</th>
                            <th>@Model.Country.CurrencyIsoCode @Model.Total</th>
                        </tr>
                    }
                </tfoot>
            </table>
        </div>
        @if (page.IsLastPage)
        {
            <div class="row footer">
                <div class=" row">
                    <div class="col-xs-4">
                        <div class="text-2x text-center">Generated by:</div>
                        <div style="display:block; border-bottom: 1px black solid">
                            <br />
                            <br />
                        </div>
                        <div class="text-2x text-center"><strong>Programs</strong></div>
                    </div>
                    <div class="col-xs-4">
                            <div class="text-2x text-center">Reviewed by:</div>
                            <div style="display:block; border-bottom: 1px black solid">
                                <br />
                                <br />
                            </div>
                            <div class="text-2x text-center"><strong>Finance</strong></div>
                    </div>
                    <div class="col-xs-4">
                        <div class="text-2x text-center">Approved by:</div>
                        <div style="display:block; border-bottom: 1px black solid">
                            <br />
                            <br />
                        </div>
                        <div class="text-2x text-center"><strong>Budget Holder</strong></div>
                    </div>
                </div>
            </div>
        }

        <div class="row">
            <div class="col-xs-4">
                Report Generated By:&nbsp;@Model.User.FullName
            </div>
            <div class="col-xs-4 text-center">
                Page @page.Page of @Model.Pages.Count()
            </div>
            <div class="col-xs-4 text-right">
                Date Report Generated: @this.DateToOffsetString(DateTime.UtcNow, (int)Model.TimezoneOffset)
            </div>
        </div>
    </div>
}
